<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API 文档 - TTS 服务</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            margin: 0;
        }
        .container {
            display: flex;
        }
        .sidebar {
            width: 260px;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            background-color: #fff;
            border-right: 1px solid #dee2e6;
            padding: 20px;
            overflow-y: auto;
        }
        .sidebar h2 {
            font-size: 20px;
            color: #007bff;
            margin-top: 0;
        }
        .sidebar ul {
            list-style: none;
            padding: 0;
        }
        .sidebar ul li a {
            color: #495057;
            text-decoration: none;
            display: block;
            padding: 8px 0;
            border-radius: 4px;
            transition: background-color 0.2s, color 0.2s;
        }
        .sidebar ul li a:hover, .sidebar ul li a.active {
            color: #007bff;
            background-color: #e9ecef;
        }
        .content {
            margin-left: 280px;
            padding: 20px 40px;
            width: calc(100% - 280px);
        }
        section {
            margin-bottom: 40px;
            padding-top: 20px; /* for anchor offset */
        }
        h1, h3 { color: #343a40; }
        h1 { border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        h3 { border-bottom: 1px solid #dee2e6; padding-bottom: 5px; margin-top: 30px; }
        p, li { font-size: 16px; color: #495057; }
        code {
            font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        pre {
            background-color: #212529;
            color: #f8f9fa;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        th, td {
            text-align: left;
            padding: 12px 15px;
            border: 1px solid #dee2e6;
        }
        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        .badge {
            display: inline-block;
            padding: 4px 8px;
            font-size: 0.8em;
            font-weight: 700;
            line-height: 1;
            text-align: center;
            white-space: nowrap;
            vertical-align: baseline;
            border-radius: .25rem;
        }
        .badge-get { background-color: #28a745; color: white; }
        .badge-required { background-color: #dc3545; color: white; }
        .badge-optional { background-color: #6c757d; color: white; }
        .home-link {
            display: block;
            margin-top: 20px;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <nav class="sidebar">
        <h2>API 文档</h2>
        <ul>
            <li><a href="#introduction">简介</a></li>
            <li><a href="#authentication">身份认证</a></li>
            <li><a href="#endpoints">端点详情</a></li>
            <li><a href="#examples">使用示例</a></li>
            <ul>
                <li><a href="#example-curl">cURL</a></li>
                <li><a href="#example-js">JavaScript</a></li>
                <li><a href="#example-python">Python</a></li>
            </ul>
        </ul>
        <a href="/" class="home-link">返回首页</a>
    </nav>

    <main class="content">
        <section id="introduction">
            <h1>简介</h1>
            <p>本文档旨在帮助开发者使用 TTS (Text-to-Speech) API 服务。通过本 API，您可以将文本转换为高质量的语音音频文件。所有 API 调用都需要通过身份验证。</p>
            <p><b>API 基础 URL:</b> <code>http://tts.elysia.cc/code> (在生产环境中会更改)</p>
        </section>

        <section id="authentication">
            <h1>身份认证</h1>
            <p>本 API 支持三种方式进行认证，服务器将按以下优先级顺序查找 Token：</p>
            <ol>
                <li><b>[推荐] Bearer Token (HTTP 请求头):</b> 在 <code>Authorization</code> 请求头中提供。
                    <pre><code>Authorization: Bearer &lt;YOUR_API_TOKEN&gt;</code></pre>
                </li>
                <li><b>URL 查询参数:</b> 在 GET 请求的 URL 中添加 <code>api_token</code> 参数。
                    <pre><code>GET /api/tts?text=...&api_token=&lt;YOUR_API_TOKEN&gt;</code></pre>
                </li>
                <li><b>请求体参数:</b> 在 POST 请求体中添加 <code>api_token</code> 字段 (当前 TTS 接口为 GET，此方法不适用，仅作说明)。
                    <pre><code>{
  "text": "...",
  "api_token": "&lt;YOUR_API_TOKEN&gt;"
}</code></pre>
                </li>
            </ol>
            <p><b>注意：</b>为了安全，强烈建议使用第一种（Bearer Token）方式，避免在 URL 中直接暴露 Token。</p>
        </section>

        <section id="endpoints">
            <h1>端点详情</h1>
            <h3><span class="badge badge-get">GET</span> /api/tts - 合成语音</h3>
            <p>此端点接收文本和配置参数，返回合成的音频文件。</p>

            <h4>查询参数 (Query Parameters)</h4>
            <table>
                <thead>
                <tr>
                    <th>参数名</th>
                    <th>要求</th>
                    <th>类型</th>
                    <th>描述</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td><code>text</code></td>
                    <td><span class="badge badge-required">必须</span></td>
                    <td>string</td>
                    <td>需要转换为语音的文本内容。建议长度不超过100个字符。</td>
                </tr>
                <tr>
                    <td><code>character</code></td>
                    <td><span class="badge badge-optional">可选</span></td>
                    <td>string</td>
                    <td>合成语音所使用的角色。默认值: <code>elysia</code>。<br>可选值: <code>elysia</code>, <code>eden</code>。</td>
                </tr>
                <tr>
                    <td><code>media_type</code></td>
                    <td><span class="badge badge-optional">可选</span></td>
                    <td>string</td>
                    <td>希望返回的音频格式。默认值: <code>wav</code>。<br>可选值: <code>wav</code>, <code>mp3</code>, <code>ogg</code>。</td>
                </tr>
                <tr>
                    <td><code>text_lang</code></td>
                    <td><span class="badge badge-optional">可选</span></td>
                    <td>string</td>
                    <td>输入文本的语言。默认值: <code>zh</code> (中文)。</td>
                </tr>
                </tbody>
            </table>

            <h4>响应 (Responses)</h4>
            <ul>
                <li><b>成功响应 (<code>200 OK</code>):</b>
                    <p>响应体为原始的音频文件二进制数据。响应头 <code>Content-Type</code> 将为 <code>audio/wav</code>, <code>audio/mp3</code> 等。</p>
                </li>
                <li><b>错误响应 (<code>4xx</code>, <code>5xx</code>):</b>
                    <p>响应体为 JSON 对象，包含错误信息。</p>
                    <pre><code>{
  "error": "具体的错误描述信息"
}</code></pre>
                </li>
            </ul>
        </section>

        <section id="examples">
            <h1>使用示例</h1>
            <p>在所有示例中，请将 <code>YOUR_API_TOKEN</code> 替换为您自己的真实 Token。</p>

            <h3 id="example-curl">cURL 示例</h3>
            <pre><code># 使用请求头认证 (推荐)
curl "http://tts.elysia.cc/api/tts?text=你好世界" \
  -H "Authorization: Bearer YOUR_API_TOKEN" \
  --output output.wav

# 使用URL参数认证
curl "http://tts.elysia.cc/api/tts?text=你好世界&api_token=YOUR_API_TOKEN" \
  --output output.wav</code></pre>

            <h3 id="example-js">JavaScript (fetch) 示例</h3>
            <pre><code>const apiToken = 'YOUR_API_TOKEN';
const text = '在JavaScript中测试API。';

const url = new URL('http://tts.elysia.cc/api/tts');
url.searchParams.set('text', text);

async function getSpeech() {
  try {
    const response = await fetch(url, {
      method: 'GET',
      headers: { 'Authorization': `Bearer ${apiToken}` }
    });

    if (!response.ok) {
      const errorData = await response.json();
      throw new Error(`API Error ${response.status}: ${errorData.error}`);
    }

    const audioBlob = await response.blob();
    console.log('成功获取音频 Blob:', audioBlob);
    // 在浏览器中，可以创建一个URL来播放
    const audioUrl = URL.createObjectURL(audioBlob);
    const audio = new Audio(audioUrl);
    audio.play();
  } catch (error) {
    console.error('请求失败:', error);
  }
}

getSpeech();</code></pre>

            <h3 id="example-python">Python (requests) 示例</h3>
            <pre><code>import requests

api_url = "http://tts.elysia.cc/api/tts"
api_token = "YOUR_API_TOKEN"

params = { "text": "使用 Python 来测试 API。" }
headers = { "Authorization": f"Bearer {api_token}" }

try:
    response = requests.get(api_url, params=params, headers=headers)
    response.raise_for_status()  # 如果状态码不是2xx，则抛出异常

    with open("output_python.wav", "wb") as f:
        f.write(response.content)
    print("语音合成成功！")
except requests.exceptions.RequestException as e:
    print(f"请求失败: {e}")
    # 尝试打印JSON错误
    try:
        print(f"错误详情: {e.response.json()}")
    except:
        pass</code></pre>
        </section>
    </main>
</div>

</body>
</html>